@{
    Layout = null;
}
@model YiQiWorkFlow.Domain.Basement.Sys_Report

<!DOCTYPE html>
<html>
<head>
    <title>打印模板编辑</title>
    <script type="text/javascript" src="/Scripts/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="/Scripts/jquery-ui-1.10.4.custom.min.js"></script>
    <link type="text/css" href="/Styles/ui-lightness/jquery-ui-1.10.4.custom.css" />
    <style type="text/css">
        body
        {
            font-size: 13px;
        }
        ul, li
        {
            list-style: none;
            list-style-type: none;
            padding: 0px;
            margin: 0px;
        }
        h1
        {
            text-align:center;
        }
        table
        {
            width: 100%;
        }
        .main
        {
            width: 28cm;
            margin: 0px auto;
        }
        .input-items
        {
            position: fixed;
            background-color: #FFF;
            bottom: 100px;
            left: 3px;
            border: solid 1px #EEE;
            float:left;
        }
        .input-items li
        {
            margin: 3px;
            background-color: #EEE;
        }
        .head-item
        {
            border: solid 1px gray;
            border-collapse: collapse;
        }
        .head-item td
        {
            width: 33%;
            min-height: 100px;
            border: solid 1px gray;
            border-collapse: collapse;
            vertical-align: top;
            padding: 5px;
        }
        .input-container
        {
            height: 100%;
            min-height: 50px;
        }
        .input-container .input-item
        {
            position: static !important;
            left: auto !important;
            top: auto !important;
        }
        .list-table, .list-table td, .list-table th
        {
            border: solid 1px gray;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .ui-sortable-placeholder
        {
            background-color: #EEE;
            visibility: visible !important;
        }
        #column-enable
        {
            background-color: #EEE;
        }
        .ui-selecting
        {
            background: #FECA40;
        }
        .ui-selected
        {
            background: #F39814;
            color: white;
        }
        .input-container li,
        li.input-item
        {
            position: relative;
        }
        em.close:after
        {
            width: 15px;
            height: 15px;
            content: '×';
            position: absolute;
            top: 5px;
            right: -10px;
            display:inline-block;
            font-style:normal;
            color:#F00;
           
        }
        .input-items em.close,
        .input-container li em.close
        {
            display:none;
            position:relative;
            width:15px;
            height:15px;
            cursor:pointer;
        }
        .input-container li:hover em.close
        {
            display: inline-block;
        }
    </style>
    <script type="text/javascript">
        $(function () {
            $(".input-item").draggable({ revert: true });

            $(".input-container").droppable({
                drop: function (event, ui) {
                    if (ui.draggable[0].className.indexOf("ui-sortable-helper") > -1) {
                        return false;
                    }
                    var dropItem = $(ui.draggable[0].outerHTML);
                    dropItem.appendTo(this);

                    //$(this).append(ui.draggable[0].outerHTML);
                    //alert(event);
                }
            });
            $(".input-container").sortable();
            $(".input-container").disableSelection();

            $(".list-table tr").sortable();

            $(".input-container").selectable();
            //            $(".input-container li:hover:after").click(function () {
            //                alert("remove")
            //            })

            $(".close").click(function () {
                $(this).parents("li:first").remove();
            });
        });
        function c(obj) {
            $(obj).parents("li:first").remove();
        }

        function Save() {
            var data = {};
            data["Header1"] = $("#header1").html();
            data["Header2"] = $("#header2").html();
            data["Header3"] = $("#header3").html();

            data["Footer1"] = $("#footer1").html();
            data["Footer2"] = $("#footer2").html();
            data["Footer3"] = $("#footer3").html();

            $(".list-table input:checkbox").each(function () {
                if ($(this).prop("checked") == true) {
                    data[$(this).prop("name")] = true;
                } else {
                    data[$(this).prop("name")] = false;
                }
            });

        }
    </script>
</head>
<body>
    <div class="input-items">
        <ul>

            @{
                foreach (YiQiWorkFlow.Domain.Basement.Sys_Report_Marks mark in ViewBag.marks as List<YiQiWorkFlow.Domain.Basement.Sys_Report_Marks>)
            {
            <li class="input-item">@mark.Title：{@mark.Name}<em class="close" onclick="javascript:c(this)"></em></li>
            }
            }
        </ul>
    </div>
    <div class="main">
        <h1>@Model.Title</h1>
        <table class="head-item">
            <tr>
                <td>
                    <ul id="header1" class="input-container">
                        @Model.Header1
                    </ul>
                </td>
                <td>
                    <ul id="header2" class="input-container">
                        @Model.Header2
                    </ul>
                </td>
                <td>
                    <ul id="header3" class="input-container">
                        @Model.Header3
                        <li>时间：2014年3月19日14:49:20<em class="close"></em></li>
                        <li>时间：2014年3月19日14:49:20<em class="close"></em></li>
                    </ul>
                </td>
            </tr>
        </table>
        <table class="list-table">
            <thead>
                <tr>
                    @{
                        foreach (var c in ViewBag.columns as List<YiQiWorkFlow.Domain.Basement.Sys_Report_Column>)
                        {
                            <th>
                                @c.Title<input name="@c.Name" type="checkbox" />
                            </th>
                        }
                    }
                </tr>
            </thead>
            <tbody>
                <tr>
                    @{
                        for (int i = 0; i < (ViewBag.columns as List<YiQiWorkFlow.Domain.Basement.Sys_Report_Column>).Count; i++)
                        {
                            <td>
                                &nbsp;
                            </td>
                        }

                    }
                </tr>
            </tbody>
        </table>
        <table class="head-item">
            <tr>
                <td>
                    <ul id="footer1" class="input-container">
                        @Model.Footer1
                    </ul>
                </td>
                <td>
                    <ul id="footer2" class="input-container">
                        @Model.Footer2
                    </ul>
                </td>
                <td>
                    <ul id="footer3" class="input-container">
                        @Model.Footer3
                    </ul>
                </td>
            </tr>
        </table>

        <div>
            <input value="保存" type="button" onclick="Save()" />
        </div>
    </div>
</body>
</html>
