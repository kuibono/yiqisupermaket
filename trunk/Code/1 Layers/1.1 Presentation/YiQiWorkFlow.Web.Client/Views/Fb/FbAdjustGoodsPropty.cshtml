<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>修改商品属性</title>
    <link type="text/css" rel="Stylesheet" href="/Styles/editPage.css" />
    <script type="text/javascript" src="/scripts/boot.js"></script>
    <script type="text/javascript" src="/Scripts/editPage.js"></script>
    <script type="text/javascript" src="/Data/c_FbSupplierArchives.js"></script>
    <script type="text/javascript"> var pageTitle = "修改商品属性"; var formChanged = false; var pageType = "Edit"; var createTime = "2014/2/15 19:58:45"; var id = ""; pageName = ""; var isNew = false;</script>
    <script type="text/javascript">
        function SaveData() {
            var form = new mini.Form("#formMain"); // default form
            var o = form.getData();

            var grid = mini.get("datagrid1");
            if (grid.isEditing()) {
                grid.commitEdit();
            }
            var gd = grid.getChanges();
            o["goods"] = mini.encode(gd);


            $.ajax({
                url: "/Fb/SaveFbAdjustGoodsPropty",
                type: 'post',
                data: o,
                cache: false,
                dataType: "json",
                success: function (r) {
                    if (r.IsSuccess == true) {
                        alert("修改成功");
                    } else {
                        $("#Tooltip_Critical_FbAdjustClass .content").first().text(r.Message);
                        $("#Tooltip_Critical_FbAdjustClass").show("fast");
                        form.unmask();
                        $(document).scrollTop(0);
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    $("#Tooltip_Critical_FbAdjustClass .content").first().text(jqXHR.responseText);
                    $("#Tooltip_Critical_FbAdjustClass").show("fast");
                    form.unmask();
                    $(document).scrollTop(0);
                }
            });
        }
        function addRow(row) {
            var grid = mini.get("datagrid1");
            grid.addRow(row, 0);
        }
        //function onGoodsChanged(e) {
        //    mini.getbyName("GbCodeOld", "datagrid1").setValue(e.selected.GbCode);
        //    mini.getbyName("GmCodeOld", "datagrid1").setValue(e.selected.GmCode);
        //    mini.getbyName("GsCodeOld", "datagrid1").setValue(e.selected.GsCode);
        //    mini.getbyName("GlCodeOld", "datagrid1").setValue(e.selected.GlCode);

        //    mini.getbyName("GbCode", "datagrid1").focus();
        //}
        $(function () {
            var grid = mini.get("datagrid1");
            jQuery.hotkeys.add('return', function () {
                if (grid.isEditing()) {
                    grid.commitEdit();
                }
                var row = {};
                grid.addRow(row, 0);
                grid.cancelEdit();
                grid.beginEditRow(row);
            });
            jQuery.hotkeys.add('esc', function () {
                grid.reload();
            });
            jQuery.hotkeys.add('del', function () {
                grid.removeRows(grid.getSelecteds());
            });

            $("#btnGoods").click(function () {
                var btnEdit = this;
                mini.open({
                    url: "/Common/GoodsSelector?OpCode=3",
                    title: "选择列表",
                    width: 600,
                    height: 380,
                    ondestroy: function (action) {
                        //if (action == "close") return false;
                        if (action == "ok") {
                            var iframe = this.getIFrameEl();
                            var data = iframe.contentWindow.GetData();
                            data = mini.clone(data);    //必须
                            if (data) {
                                for (var i = 0; i < data.length; i++) {

                                    addRow(data[i]);
                                }
                            }
                        }

                    }
                });
            });
            $("#btnQuery").click(function () {
                location.href = "/Fb/FbAdjustClassList";
            });
        });
    </script>
    <style type="text/css">
        .ablock {
            width:auto !important;
            height:21px;
        }
        .ablock label {
            display: inline-block;
            width: 80px;
            font-weight: normal;
            float: left;
            }
        .ablock span.mini-buttonedit {
            width:auto !important;
        }
        .mini-textbox {
            width:auto !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>更改商品属性
        </h1>
        <div class="tooltip warning hidden" id="Tooltip_Warning_FbAdjustClass">
            <img src="/images/Warning.png" alt="Warning" height="48" width="48" />
            <p class="content">
                此处填写关于调商品所属类别编辑页面的警告信息
            </p>
            <div class="button-close">
                x
            </div>
            <div class="buttonGroup">
                <input type="button" class="myYellowButton buttonNoMoreShow" value="不再显示" />
                <input type="button" class="myYellowButton buttonClose" value="关闭" />
            </div>
        </div>
        <div class="tooltip info hidden" id="Tooltip_Info_FbAdjustClass">
            <img src="/images/Info.png" alt="Warning" height="48" width="48" />
            <p class="content">
                此处填写关于调商品所属类别编辑页面的提示信息
            </p>
            <div class="button-close">
                x
            </div>
            <div class="buttonGroup">
                <input type="button" class="myYellowButton buttonNoMoreShow" value="不再显示" />
                <input type="button" class="myYellowButton buttonClose" value="关闭" />
            </div>
        </div>
        <div class="tooltip help hidden" id="Tooltip_Help_FbAdjustClass">
            <img src="/images/Help.png" alt="Warning" height="48" width="48" />
            <p class="content">
                此处填写关于调商品所属类别编辑页面的帮助信息
            </p>
            <div class="button-close">
                x
            </div>
            <div class="buttonGroup">
                <input type="button" class="myYellowButton buttonNoMoreShow" value="不再显示" />
                <input type="button" class="myYellowButton buttonClose" value="关闭" />
            </div>
        </div>
        <div class="tooltip critical hidden" id="Tooltip_Critical_FbAdjustClass">
            <img src="/images/critical.png" alt="Warning" height="48" width="48" />
            <p class="content">
                此处填写关于调商品所属类别编辑页面的出错信息
            </p>
            <div class="button-close">
                x
            </div>
            <div class="buttonGroup">
                <input type="button" class="myYellowButton buttonNoMoreShow" value="不再显示" />
                <input type="button" class="myYellowButton buttonClose" value="关闭" />
            </div>
        </div>
        <form id="formMain" method="post" action="">
            <fieldset>
                <legend>基本信息</legend>
                <table border="1" style="border: solid 1px #808080; border-collapse: collapse;">
                    <thead>
                        <tr>
                            <th>是否修改
                            </th>
                            <th>商品属性
                            </th>
                        </tr>
                    </thead>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="GoodsType" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_GoodsType">商品类型:</label>
                                <input type="text" value="" class="mini-combobox" name="GoodsType" id="Control_GoodsType" data="c_GoodsType" onvaluechanged="setBindtabEnable" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="CheckMode" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_CheckMode">核算方式:</label>
                                <input type="text" value="" class="mini-combobox" name="CheckMode" id="Control_CheckMode" data="[{id:'1',text:'先进先出'}]" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="CheckUnitCode" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_CheckUnitCode">核算单位:</label>
                                <input type="text" value="" class="mini-textbox" name="CheckUnitCode" id="Control_CheckUnitCode" vtype="maxLength:20" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="UnderCounterCode" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_UnderCounterCode">所属柜台:</label>
                                <input type="text" class="mini-combobox" name="UnderCounterCode" id="Control_UnderCounterCode" url="/Common/GetComboData?table=fb_pa_goods_counter&valueColumn=counter_code&textColumn=counter_name" vtype="maxLength:20" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="ArticleNumber" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_ArticleNumber">货号:</label>
                                <input type="text" class="mini-textbox" name="ArticleNumber" id="Control_ArticleNumber" vtype="maxLength:20" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="ProducingArea" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_ProducingArea">产地:</label>
                                <input type="text" class="mini-textbox" name="ProducingArea" id="Control_ProducingArea" vtype="maxLength:100" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="Specification" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_Specification">规格:</label>
                                <input type="text" class="mini-textbox" name="Specification" id="Control_Specification" vtype="maxLength:20" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="PackUnitCode" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_PackUnitCode">包装单位:</label>
                                <input type="text" class="mini-combobox" name="PackUnitCode" id="Control_PackUnitCode" url="/Common/GetComboData?table=fb_pa_goods_pack_unit&valueColumn=pack_unit_code&textColumn=pack_unit_name" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="ShelfLife" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_ShelfLife">保质期(天):</label>
                                <input type="text" class="mini-spinner" minvalue="1" maxvalue="1000" decimalplaces="0" name="ShelfLife" id="Control_ShelfLife" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="StockUpperLimit" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_StockUpperLimit">库存上限:</label>
                                <input type="text" id="Control_StockUpperLimit" name="StockUpperLimit" class="mini-spinner" minvalue="0" maxvalue="1000" decimalplaces="2" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="StockLowerLimit" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_StockLowerLimit">库存下限:</label>
                                <input type="text" id="Control_StockLowerLimit" name="StockLowerLimit" class="mini-spinner" minvalue="0" maxvalue="1000" decimalplaces="2" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="middle" align="center">
                            <input type="checkbox" name="IfExamine" />
                        </td>
                        <td>
                            <div class="ablock">
                                <label for="Control_StockLowerLimit">是否审核:</label>
                                <div id="Control_IfExamine" name="IfExamine" class="mini-checkbox" enabled="false" readonly="false" trueValue="1" falseValue="0"></div>
                            </div>
                        </td>
                    </tr>
                </table>
            </fieldset>
            <div id="datagrid1" class="mini-datagrid"
                style="width: 100%; height: 300px; margin-top: 10px;" idfield="id" allowresize="false" sizelist="[20,30,50,100]"
                pagesize="20" multiselect="true" showfilterrow="false" showpager="false" onrowdblclick="onrowdblclick">
                <div property="columns">
                    <div type="indexcolumn" width="30">
                    </div>
                    <div type="checkcolumn" width="30">
                    </div>
                    <div field="Id" headeralign="center" align="center" width="150">
                        商品编码
					<input id="filter_GoodsCode" name="GoodsCode" property="editor" class="mini-combobox" allowinput="true" valuefield="Id" textfield="GoodsName" onvaluechanged="onGoodsChanged" url="/Fb/SearchFbGoodsArchivesListForList" style="width: 100%;" />
                    </div>
                    <div field="GoodsBarCode" headeralign="center" align="center" width="100">
                        商品销售码
					<input id="filter_GoodsBarCode" name="GoodsBarCode" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="GoodsName" headeralign="center" align="center" width="150">
                        商品名称
					<input id="filter_GoodsName" name="GoodsName" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="GoodsState" headeralign="center" align="center" width="80" renderer="onGoodsStateRender">
                        商品状态
					<input id="filter_GoodsState" name="GoodsState" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="GoodsType" headeralign="center" align="center" width="80" renderer="onGoodsTypeRender">
                        商品类型
					<input id="filter_GoodsType" name="GoodsType" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="SupCode" headeralign="center" align="center" width="80" renderer="onSupCodeRender">
                        供货商
					<input id="filter_SupCode" name="SupCode" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="OpCode" headeralign="center" align="center" width="70" renderer="onOpCodeRender">
                        经营方式
					<input id="filter_OpCode" name="OpCode" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="PoolRate" headeralign="center" align="center" width="60">
                        扣率
					<input id="filter_PoolRate" name="PoolRate" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="PurchasePrice" headeralign="center" align="center" width="80">
                        含税进价
					<input id="filter_PurchasePrice" name="PurchasePrice" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="NontaxPurchasePrice" headeralign="center" align="center" width="100">
                        不含税进价
					<input id="filter_NontaxPurchasePrice" name="NontaxPurchasePrice" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="SalePrice" headeralign="center" align="center" width="60">
                        销售价
					<input id="filter_SalePrice" name="SalePrice" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="VipPrice" headeralign="center" align="center" width="60">
                        会员价
					<input id="filter_VipPrice" name="VipPrice" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="TradePrice" headeralign="center" align="center" width="60">
                        批发价
					<input id="filter_TradePrice" name="TradePrice" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="ProducingArea" headeralign="center" align="center" width="60">
                        产地
					<input id="filter_ProducingArea" name="ProducingArea" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="ArticleNumber" headeralign="center" align="center" width="60">
                        货号
					<input id="filter_ArticleNumber" name="ArticleNumber" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="Specification" headeralign="center" align="center" width="60">
                        规格
					<input id="filter_Specification" name="Specification" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="ShelfLife" headeralign="center" align="center" width="60">
                        保质期
					<input id="filter_ShelfLife" name="ShelfLife" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="PackUnitCode" headeralign="center" align="center" width="80">
                        包装单位
					<input id="filter_PackUnitCode" name="PackUnitCode" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="OfferMode" headeralign="center" align="center" width="80">
                        供货方式
					<input id="filter_OfferMode" name="OfferMode" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="PackCoef" headeralign="center" align="center" width="80">
                        包装系数
					<input id="filter_PackCoef" name="PackCoef" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="OfferMin" headeralign="center" align="center" width="80">
                        最小订量
					<input id="filter_OfferMin" name="OfferMin" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="GrossRate" headeralign="center" align="center" width="70">
                        毛利率
					<input id="filter_GrossRate" name="GrossRate" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                    <div field="GoodsSubName" headeralign="center" align="center" width="80">
                        商品简称
					<input id="filter_GoodsSubName" name="GoodsSubName" property="editor" class="mini-textbox" enabled="false" style="width: 100%;" />
                    </div>
                </div>
            </div>
            <div class="clear">
            </div>
            <div class="control-panel">
                <div class="control-button">
                    <input type="button" class="myButton" id="btnFormSubmit" value="保存(Ctrl+S)" />
                    <input type="button" class="myButton" id="btnGoods" value="商品" />
                    <input type="button" class="myRedButton" id="btnClosePage" value="关闭(Ctrl+Q)" />
                </div>
                <div class="botton-up">
                </div>
            </div>
        </form>
    </div>
</body>
</html>
